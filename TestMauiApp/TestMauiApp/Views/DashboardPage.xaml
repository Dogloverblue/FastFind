<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
	xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TestMauiApp.Views.DashboardPage"
	xmlns:local="clr-namespace:TestMauiApp.Controls"
             Title="FastFind">
    <!-- Root: left sidebar | divider | scrollable tile grid -->
    <Grid ColumnDefinitions="260,3,*" Padding="16">

        <Grid Grid.Column="0"
      RowDefinitions="Auto,Auto,*"
            Padding="0"
      RowSpacing="12">

            <!-- LEFT: text + toggles -->
        <VerticalStackLayout Grid.Column="0" Spacing="12">
            
            <Label Text="Settings" FontSize="28" FontAttributes="Bold" />
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">
                <Switch IsToggled="{Binding Setting1}" />
                <Label Grid.Column="1" Text="Scan Enabled" VerticalTextAlignment="Center"/>
            </Grid>
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">
                <Switch IsToggled="{Binding Setting2}" />
                <Label Grid.Column="1" Text="Auto Refresh" VerticalTextAlignment="Center"/>
            </Grid>
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">
                <Switch IsToggled="{Binding Setting3}" />
                <Label Grid.Column="1" Text="Include Large Subdirectories" VerticalTextAlignment="Center"/>
            </Grid>
            <Label Text="Files" FontAttributes="Bold" Margin="0,8,0,0"/>
            <!-- Row: path Entry + browse + Add -->
            
            <Grid ColumnDefinitions="*,Auto,Auto">
                    
                <Entry x:Name="PathEntry"
               Grid.Column="0"
               Placeholder="Paste or pick a file path"
               ClearButtonVisibility="WhileEditing" />
                
                
                
                <Button Grid.Column="1"
                Text="…"
                Padding="12,0"
                ToolTipProperties.Text="Pick a file"
                Clicked="OnBrowseClicked"/>
                <Button Grid.Column="2"
                Text="Add"
                Padding="12,0"
                Clicked="OnAddPathClicked"/>
            </Grid>
            </VerticalStackLayout>
            <!-- List of paths -->

            <CollectionView x:Name="Items" Grid.Row="2" ItemsSource="{Binding FilePaths}"
                    VerticalOptions="Center"
                    BackgroundColor="#363636"
                            >
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="5" Margin="5"
                   HasShadow="False"
                   CornerRadius="6">
                            <Frame.Background>
                                <SolidColorBrush Color="#00FFFFFF"/>
                                <!-- Transparent -->
                            </Frame.Background>

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <!-- Default State -->
                                    <VisualState x:Name="Normal">
                                        <VisualState.Setters>
                                            <Setter TargetName="FrameContent"
                                        Property="Background"
                                        Value="#00FFFFFF"/>
                                        </VisualState.Setters>
                                    </VisualState>

                                    <!-- Hover State -->
                                    <VisualState x:Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter TargetName="FrameContent"
                                        Property="Background"
                                        Value="#20FFFFFF"/>
                                            <!-- Slightly white -->
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>

                            <Grid x:Name="FrameContent" ColumnDefinitions="*,Auto">
                                <Label Grid.Column="0" VerticalTextAlignment="Center" Text="{Binding}" FontSize="12" />
                                <Button Text="🗑️"
                            Grid.Column="1"
                            HeightRequest="16"
                                        WidthRequest="16"
                            Padding="0"
                            BackgroundColor="Transparent"
                            Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}},
                                       Path=BindingContext.RemovePathCommand}"
                     CommandParameter="{Binding .}"
                            SemanticProperties.Hint="Delete this item"/>
                                <!--<Button Text="A" FontSize="8"></Button> -->
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>
        <!-- DIVIDER -->
        <BoxView Grid.Column="1" WidthRequest="2" Color="{DynamicResource SeparatorColor}" />
        <!-- RIGHT: scrollable grid of square cards -->
        <CollectionView Grid.Column="2"
                        ItemsSource="{Binding Cards}"
                        ItemSizingStrategy="MeasureAllItems">
            <CollectionView.ItemsLayout>
                <!-- change Span to 2/3/4 etc. to control columns -->
                <GridItemsLayout Orientation="Vertical" Span="3"/>
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <!-- Square tile with rounded corners -->
                    <local:SquareView Margin="12">
                        <Border StrokeThickness="1"
                    Stroke="#1F000000"
                    Background="{AppThemeBinding Light=#FFFFFF, Dark=#383838}"
                    StrokeShape="RoundRectangle 22">
                            <Border.Shadow>
                                <Shadow Radius="12" Opacity="0.25" Offset="0,6" />
                            </Border.Shadow>
                            <!-- Content of the card -->
                            <Grid Padding="16" RowDefinitions="Auto,Auto,*">
                                <Label Text="{Binding Title}"
                           FontAttributes="Bold"
                           FontSize="18"/>
                                <Label Grid.Row="1"
                           Text="{Binding Subtitle}"
                           Opacity="0.75"
                           LineBreakMode="TailTruncation"/>
                                <!-- Optional icon/placeholder block -->
                                <Grid Grid.Row="2"
                          Margin="4,12,4,0"
                          BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}">
                                    <!-- ClipToBounds="True" -->
                                    <!-- CornerRadius="14"> #2A2A2A-->
                                    <!-- Put an Image here if you have one -->
                                    <Image Source="{Binding ImagePath}" Aspect="AspectFill"/>
                                    <Label Text="• • •" HorizontalOptions="Center" VerticalOptions="Center" Opacity="0.6"/>
                                </Grid>
                            </Grid>
                            <!-- Hover/pressed feedback -->
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="Shadow">
                                                <Shadow Radius="16" Opacity="0.35" Offset="0,10" />
                                            </Setter>
                                            <Setter Property="Stroke" Value="#33000000"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="Background" Value="{AppThemeBinding Light=#F0F0F0, Dark=#262626}"/>
                                            <Setter Property="Stroke" Value="#55000000"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <!-- Make the whole card tappable -->
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.CardTappedCommand}"
                                          CommandParameter="{Binding .}"/>
                            </Border.GestureRecognizers>
                        </Border>
                    </local:SquareView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>


